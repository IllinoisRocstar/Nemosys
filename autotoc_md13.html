<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NEMoSys: Install from Source</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="IRTriangles_small.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NEMoSys
   &#160;<span id="projectnumber">0.62.1</span>
   </div>
   <div id="projectbrief">A modular, extensible resource with robust automated mesh generation, mesh quality analysis, adaptive mesh refinement, and data transfer between arbitrary meshes.</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('autotoc_md13.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Install from Source </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><blockquote class="doxtable">
<p>These instructions detail how to build and install <em>Promesh</em> from source. For a much faster installation, consider using Conda.</p>
<p><a href="https://anaconda.org/illinoisrocstar/promesh"></a> </p>
</blockquote>
<p><em>Promesh</em> is a modular, extensible resource designed for use in typical application development systems as well as distributed web-services environments. The project focus is providing a framework for robust, automated mesh generation, mesh quality analysis, adaptive mesh refinement, and data transfer between arbitrary meshes. Python bindings to the <em>Promesh</em> library can also be enabled.</p>
<blockquote class="doxtable">
<p><b>Note:</b> These installation guides have been tested for Ubuntu 18.04 and CentOS 7 systems. </p>
</blockquote>
<p>Before <em>Promesh</em> can be installed, there are some dependencies and third party libraries (TPLs) that must be acquired and installed. Some of these can be obtained on Unix machines via <code>apt install</code>:</p>
<p><b>Ubuntu:</b></p>
<p>Start with: </p><div class="fragment"><div class="line">apt update --fix-missing</div></div><!-- fragment --><ul>
<li><b>build-essential</b> - GCC compiler. Alternatively, your favorite compiler.</li>
<li><b>cmake</b> - Alternatively, latest version also available from <a href="https://cmake.org/download/">Kitware</a></li>
<li><b>doxygen</b> - Documentation requirement</li>
<li><b>graphviz</b> - Documentation requirement</li>
<li><b>libgl1-mesa-dev</b> - <em>VTK</em> requirement</li>
<li><b>libxt-dev</b> - <em>VTK</em> requirement</li>
<li><b>zlib1g-dev</b> - <em>Netgen</em> requirement</li>
<li><b>tk-dev</b> - <em>OpenCASCADE</em> requirement</li>
<li><b>libfreetype6-dev</b> - <em>OpenCASCADE</em> requirement</li>
<li><b>mesa-common-dev</b> - <em>OpenCASCADE</em> requirement</li>
<li><b>libxmu-dev</b> - <em>OpenCASCADE</em> requirement</li>
<li><b>libxi-dev</b> - <em>OpenCASCADE</em> requirement</li>
</ul>
<p>Optional dependencies for additional functionality:</p><ul>
<li><b>cmake-curses-gui</b> - CMake visualization tool</li>
<li><b>libhdf5-dev</b> - <em>HDF5</em> requirement</li>
<li><b>libpython3-dev</b> - Required for Python bindings</li>
<li><b>swig3.0</b> - Required for Python bindings</li>
<li><b>libfltk1.3-dev</b> - <em>Gmsh</em> requirement</li>
<li><b>libmetis-dev</b> - <em>METIS</em> requirement</li>
</ul>
<p><b>CentOS:</b></p>
<p>Start with </p><div class="fragment"><div class="line">yum update</div><div class="line">yum upgrade</div><div class="line">yum install https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm</div><div class="line"></div><div class="line">yum groupinstall &quot;Development Tools&quot;</div></div><!-- fragment --><p> Then install via <code>yum install</code>:</p><ul>
<li><b>centos-release-scl</b> - Makes the developer toolset available</li>
<li><b>devtoolset-7</b> - Provides the necessary compiler version.</li>
<li><b>cmake3</b> - Provides the modern CMake required</li>
<li><b>doxygen</b> - Documentation requirement</li>
<li><b>graphviz</b> - Documentation requirement</li>
<li><b>tk-devel</b> - <em>OpenCASCADE</em> requirement</li>
<li><b>mesa-libGL-devel</b> - <em>OpenCASCADE</em> requirement</li>
<li><b>libX11-devel</b> - <em>OpenCASCADE</em> requirement</li>
<li><b>libXmu-devel</b> - <em>OpenCASCADE</em> requirement</li>
<li><b>libXi-devel</b> - <em>OpenCASCADE</em> requirement</li>
<li><b>libXext-devel</b> - <em>OpenCASCADE</em> requirement</li>
</ul>
<p>Optional dependencies for additional functionality:</p><ul>
<li><b>hdf5-devel</b> - <em>HDF5</em> requirement</li>
<li><b>python3-devel</b> - Required for Python bindings</li>
<li><b>swig3</b> - Required for Python bindings</li>
<li><b>metis-devel</b> - <em>METIS</em> requirement</li>
</ul>
<p>Once <b>devtoolset-7</b> is installed, ensure that the newer compiler is enabled with: </p><div class="fragment"><div class="line">source /opt/rh/devtoolset-7/enable</div></div><!-- fragment --><p>Third party libraries must be downloaded individually and installed with certain options; instructions for each are provided. Note that as <em>Promesh</em> is in active development, the versions of these libraries that are used may change. For that reason, it is recommended to acquire the source code via GitLab/GitHub whenever possible, since that method allows for easy version updates.</p>
<p>Currently, the libraries are:</p><ul>
<li><em>VTK</em> v8.2.0</li>
<li><em>Boost</em> v1.45+</li>
<li><em>OpenCASCADE</em> v7.4.0</li>
<li><em>Netgen</em> v6.2.1910 (strongly recommended)</li>
<li><em>Kokkos</em> v2+ (optional; used for GPU-enabled adaptive mesh refinement)</li>
<li><em>Gmsh</em> v4.5.1 (optional; <b>GPL license</b>)</li>
<li><em>OpenFOAM</em> v2006 (optional; <b>GPL license</b>)</li>
</ul>
<p>Because these are third party, we cannot guarantee that the links below will be active or correct in perpetuity.</p>
<p>Note that all the TPLs will be installed to the same directory. To streamline compilation and installation, an alias can be created: </p><div class="fragment"><div class="line">export PROMESH_DEPS_INSTALL_PATH=/path/to/desired/installation/path</div></div><!-- fragment --><p>VTK v8.2.0 is required. VTK provides the core mesh data structure upon which <em>Promesh</em> is based.</p>
<p><b>Source</b></p>
<p>VTK can be downloaded from <a href="https://gitlab.kitware.com/vtk/vtk">the VTK GitLab</a>. In a terminal, navigate to the directory that will contain the source code for each TPL then clone from the VTK GitLab via: </p><div class="fragment"><div class="line">git clone https://gitlab.kitware.com/vtk/vtk.git</div></div><!-- fragment --><p> Enter the newly created VTK directory then check out the correct version: </p><div class="fragment"><div class="line">cd vtk</div><div class="line">git checkout v8.2.0</div></div><!-- fragment --><p>Alternatively, it can be obtained from <a href="https://vtk.org/download/">the VTK website</a>. It can be downloaded as a .tar or .zip. This archive can then be extracted to the desired source directory (<em>not</em> the installation path).</p>
<p><b>Build and Install</b></p>
<p>Build and install VTK by running the following commands:</p>
<div class="fragment"><div class="line">mkdir build &amp;&amp; cd build</div></div><!-- fragment --> <table class="doxtable">
<tr>
<th>If your system is... </th><th align="left">use the command...  </th></tr>
<tr>
<td>Ubuntu </td><td align="left"><code>cmake .. -DCMAKE_INSTALL_PREFIX=${PROMESH_DEPS_INSTALL_PATH}/vtk</code> </td></tr>
<tr>
<td>CentOS </td><td align="left"><code>cmake3 .. -DCMAKE_INSTALL_PREFIX=${PROMESH_DEPS_INSTALL_PATH}/vtk</code> </td></tr>
</table>
<div class="fragment"><div class="line">make -j$(nproc)</div><div class="line">make install</div></div><!-- fragment --><p><em>Boost</em> is required for the base meshing capabilities of <em>Promesh</em> The file system included with <em>Boost</em> v1.45+ is required for mesh generation with <em>OpenFOAM</em>.</p>
<p>The best way to obtain <em>Boost</em> is to get it from your systems package manager, for example:</p>
<table class="doxtable">
<tr>
<th>If your system is... </th><th align="left">use the command...  </th></tr>
<tr>
<td>Ubuntu </td><td align="left"><code>apt install libboost-all-dev</code> </td></tr>
<tr>
<td>CentOS </td><td align="left"><code>yum install boost-devel</code> </td></tr>
</table>
<p>If <em>Boost</em> is not available through your package manager, detailed installation instructions can be <a href="https://www.boost.org/doc/libs/1_78_0/more/getting_started/index.html">found here.</a></p>
<p><em>OpenCASCADE</em> v7.4.0 is required. It provides the geometry kernel used in the Nucmesh and Packmesh modules.</p>
<p><b>Source</b></p>
<p><em>OpenCASCADE</em> is available at <a href="https://dev.opencascade.org/release/previous#node-29988">the <em>OpenCASCADE</em> website</a>. Note that you will have to make a free account to get access to the source code.</p>
<p>This archive can then be extracted to the desired source directory.</p>
<p><em>OpenCASCADE</em> is also available through <a href="https://github.com/Open-Cascade-SAS/OCCT">this GitHub page</a>, which is an official mirror of the source code. In a terminal, navigate to the directory that will contain the source code for each TPL, then clone from the GitHub via: </p><div class="fragment"><div class="line">git clone https://github.com/Open-Cascade-SAS/OCCT.git</div></div><!-- fragment --><p> Enter the newly created OCCT directory then check out the correct version: </p><div class="fragment"><div class="line">cd OCCT</div><div class="line">git checkout V7_4_0</div></div><!-- fragment --><p><b>Build and Install</b></p>
<p>Build and install <em>OpenCASCADE</em> by running the following commands: </p><div class="fragment"><div class="line">mkdir build &amp;&amp; cd build</div></div><!-- fragment --><table class="doxtable">
<tr>
<th>If your system is... </th><th align="left">use the command...  </th></tr>
<tr>
<td>Ubuntu </td><td align="left"><code>cmake .. -DCMAKE_INSTALL_PREFIX=${PROMESH_DEPS_INSTALL_PATH}/opencascade -DBUILD_SHARED_LIBS=ON</code> </td></tr>
<tr>
<td>CentOS </td><td align="left"><code>cmake3 .. -DCMAKE_INSTALL_PREFIX=${PROMESH_DEPS_INSTALL_PATH}/opencascade -DBUILD_SHARED_LIBS=ON</code> </td></tr>
</table>
<div class="fragment"><div class="line">make -j$(nproc)</div><div class="line">make install</div></div><!-- fragment --><p><em>Netgen</em> v6.2.1910 is strongly recommended. It provides enhanced mesh generation capabilities and is required for quad meshing.</p>
<p><b>Source</b></p>
<p><em>Netgen</em> can be downloaded through its <a href="https://github.com/NGSolve/netgen">GitHub page</a>. In a terminal, navigate to the directory that will contain the source code for each TPL, then clone from the GitHub via: </p><div class="fragment"><div class="line">git clone https://github.com/NGSolve/netgen.git</div></div><!-- fragment --><p> Enter the newly created netgen directory then check out the correct version: </p><div class="fragment"><div class="line">cd netgen</div><div class="line">git checkout v6.2.1910</div></div><!-- fragment --><p><b>Build and Install</b></p>
<blockquote class="doxtable">
<p><b>Note:</b> <em>OpenCASCADE</em> must be installed prior to making and installing <em>Netgen</em>. </p>
</blockquote>
<p>Build and install <em>Netgen</em> by running the following commands: </p><div class="fragment"><div class="line">mkdir build &amp;&amp; cd build</div></div><!-- fragment --><table class="doxtable">
<tr>
<th>If your system is... </th><th align="left">use the command...  </th></tr>
<tr>
<td>Ubuntu </td><td align="left"><code>cmake .. -DCMAKE_INSTALL_PREFIX=${PROMESH_DEPS_INSTALL_PATH}/netgen -DUSE_GUI=OFF -DUSE_PYTHON=OFF -DUSE_SUPERBUILD=OFF -DUSE_OCC=ON -DOCC_INCLUDE_DIR=${PROMESH_DEPS_INSTALL_PATH}/opencascade/include/opencascade -DOCC_LIBRARY=${PROMESH_DEPS_INSTALL_PATH}/opencascade/lib/libTKernel.so</code> </td></tr>
<tr>
<td>CentOS </td><td align="left"><code>cmake3 .. -DCMAKE_INSTALL_PREFIX=${PROMESH_DEPS_INSTALL_PATH}/netgen -DUSE_GUI=OFF -DUSE_PYTHON=OFF -DUSE_SUPERBUILD=OFF -DUSE_OCC=ON -DOCC_INCLUDE_DIR=${PROMESH_DEPS_INSTALL_PATH}/opencascade/include/opencascade -DOCC_LIBRARY=${PROMESH_DEPS_INSTALL_PATH}/opencascade/lib/libTKernel.so</code> </td></tr>
</table>
<div class="fragment"><div class="line">make -j$(nproc)</div><div class="line">make install</div></div><!-- fragment --><p><em>Kokkos</em> v2 is required for GPU-enabled mesh adaptation with <em><a class="el" href="namespaceOmega__h.html">Omega_h</a></em>.</p>
<p><b>Source</b></p>
<p><em>Kokkos</em> can be downloaded through <a href="https://github.com/kokkos/kokkos">its GitHub page</a>. In a terminal, navigate to the directory that will contain the source code for each TPL, then clone from the GitHub via: </p><div class="fragment"><div class="line">git clone https://github.com/kokkos/kokkos.git</div></div><!-- fragment --><p> Enter the newly created kokkos directory. </p><div class="fragment"><div class="line">cd kokkos</div></div><!-- fragment --><p><b>Build and Install</b></p>
<p>Build and install <em>Kokkos</em> with CUDA backend using the following: </p><div class="fragment"><div class="line">mkdir build &amp;&amp; cd build</div></div><!-- fragment --> <table class="doxtable">
<tr>
<th>If your system is... </th><th align="left">use the command...  </th></tr>
<tr>
<td>Ubuntu </td><td align="left"><code>cmake ${KOKKOS_SRC} -DCMAKE_CXX_COMPILER=${KOKKOS_SRC}/bin/nvcc_wrapper -DCMAKE_INSTALL_PREFIX=${PROMESH_DEPS_INSTALL_PATH}/kokkos -DCMAKE_POSITION_INDEPENDENT_CODE=ON -DCKOKKOS_ARCH=${CUDA_ARCH_CC} -DKOKKOS_ENABLE_CUDA=ON -DKOKKOS_ENABLE_CUDA_LAMBDA=ON -DBUILD_SHARED_LIBS=ON</code> </td></tr>
<tr>
<td>CentOS </td><td align="left"><code>cmake3 ${KOKKOS_SRC} -DCMAKE_CXX_COMPILER=${KOKKOS_SRC}/bin/nvcc_wrapper -DCMAKE_INSTALL_PREFIX=${PROMESH_DEPS_INSTALL_PATH}/kokkos -DCMAKE_POSITION_INDEPENDENT_CODE=ON -DCKOKKOS_ARCH=${CUDA_ARCH_CC} -DKOKKOS_ENABLE_CUDA=ON -DKOKKOS_ENABLE_CUDA_LAMBDA=ON -DBUILD_SHARED_LIBS=ON</code> </td></tr>
</table>
<div class="fragment"><div class="line">make install</div></div><!-- fragment --><p> where <code>${KOKKOS_SRC}</code> is the source directory and <code>${CUDA_ARCH_CC}</code> refers to the architecture and compute capability of your GPU, from the list <code>Kepler30 Kepler32 Kepler35 Kepler37 Maxwell50 Maxwell52 Maxwell53 Pascal60 Pascal61 Volta70 Volta72</code>.</p>
<blockquote class="doxtable">
<p><b>Note:</b> During the building and installation of <em>Promesh</em>, the user will need to provide the installation path for this library using the <code>-DCMAKE_PREFIX_PATH</code> flag along with other dependencies of <em>Promesh</em>. </p>
</blockquote>
<div class="fragment"><div class="line">-DENABLE_MLAMR=ON</div><div class="line">-DCMAKE_PREFIX_PATH=&quot;\</div><div class="line">${PROMESH_DEPS_INSTALL_PATH}/opencascade;\</div><div class="line">${PROMESH_DEPS_INSTALL_PATH}/gmsh;\</div><div class="line">${PROMESH_DEPS_INSTALL_PATH}/vtk;\</div><div class="line">${PROMESH_DEPS_INSTALL_PATH}/netgen;</div></div><!-- fragment --><p><em>Gmsh</em> v4.5.1 is optional, and <b>it is important to note that enabling it will result in a GPL, rather than LGPL software.</b></p>
<p><b>Source</b></p>
<p><em>Gmsh</em> can be downloaded through its <a href="https://gitlab.onelab.info/gmsh/gmsh/">GitLab page</a>. In a terminal, navigate to the directory that will contain the source code for each TPL, then clone from the GitLab via: </p><div class="fragment"><div class="line">git clone https://gitlab.onelab.info/gmsh/gmsh.git</div></div><!-- fragment --><p> Enter the newly created gmsh directory then check out the correct version: </p><div class="fragment"><div class="line">cd gmsh</div><div class="line">git checkout gmsh_4_5_1</div></div><!-- fragment --><p><b>Build and Install</b></p>
<blockquote class="doxtable">
<p><b>Note:</b> <em>OpenCASCADE</em> must be installed prior to making and installing <em>Gmsh</em>. </p>
</blockquote>
<p>Build and install <em>Gmsh</em> by running the following commands: </p><div class="fragment"><div class="line">mkdir build &amp;&amp; cd build</div></div><!-- fragment --> <table class="doxtable">
<tr>
<th>If your system is... </th><th>use the command...  </th></tr>
<tr>
<td>Ubuntu </td><td><code>cmake .. -DCMAKE_INSTALL_PREFIX=${PROMESH_DEPS_INSTALL_PATH}/gmsh -DCMAKE_PREFIX_PATH=${PROMESH_DEPS_INSTALL_PATH}/opencascade -DENABLE_BUILD_LIB=OFF -DENABLE_BUILD_SHARED=ON -DENABLE_PRIVATE_API=ON -DDEFAULT=ON -DENABLE_CGNS=OFF -DENABLE_NETGEN=OFF -DENABLE_HXT=ON -DENABLE_FLTK=ON -DENABLE_BUILD_DYNAMIC=ON -DENABLE_OPENMP=ON</code> </td></tr>
<tr>
<td>CentOS </td><td><code>cmake3 .. -DCMAKE_INSTALL_PREFIX=${PROMESH_DEPS_INSTALL_PATH}/gmsh -DCMAKE_PREFIX_PATH=${PROMESH_DEPS_INSTALL_PATH}/opencascade -DENABLE_BUILD_LIB=OFF -DENABLE_BUILD_SHARED=ON -DENABLE_PRIVATE_API=ON -DDEFAULT=ON -DENABLE_CGNS=OFF -DENABLE_NETGEN=OFF -DENABLE_HXT=ON -DENABLE_FLTK=ON -DENABLE_BUILD_DYNAMIC=ON -DENABLE_OPENMP=ON</code> </td></tr>
</table>
<div class="fragment"><div class="line">make -j$(nproc)</div><div class="line">make install</div></div><!-- fragment --><p><em>OpenFOAM</em> v2006 is optional, and <b>it is important to note that enabling it will result in a GPL, rather than LGPL software.</b> <em>OpenFOAM</em> provides enhanced meshing support, including snappyHexMesh, cfMesh, and blockMesh.</p>
<p>The easiest way to install <em>OpenFOAM</em> is via the precompiled system package, with instructions available <a href="https://develop.openfoam.com/Development/openfoam/-/wikis/precompiled/">here</a>. To install on Ubuntu, execute the following commands: </p><div class="fragment"><div class="line">curl -s https://dl.openfoam.com/add-debian-repo.sh | sudo bash</div><div class="line">apt-get install openfoam2006-default</div></div><!-- fragment --><p>For CentOS: </p><div class="fragment"><div class="line">yum install dnf-plugins-core</div><div class="line">yum config-manager --set-enabled PowerTools</div><div class="line">yum install epel-release</div><div class="line"></div><div class="line">dnf copr enable openfoam/openfoam</div><div class="line">yum install openfoam2006 </div></div><!-- fragment --><p>Once all the third party libraries have been installed, <em>Promesh</em> can be downloaded and installed.</p>
<p>To acquire <em>Promesh</em>, you can download it from Illinois Rocstar's GitHub or clone it with the following command: </p><div class="fragment"><div class="line">git clone https://github.com/IllinoisRocstar/Nemosys.git</div></div><!-- fragment --><blockquote class="doxtable">
<p><b>Warning:</b> The <em>Promesh</em> installation path (<code>PROMESH_INSTALL_PATH</code>) should not be the same as the source location (<code>PROMESH_PROJECT_PATH</code>). It is however acceptable that Promesh and its dependencies be installed in the same directory, such that <code>PROMESH_INSTALL_PATH</code> leads to the same directory as <code>PROMESH_DEPS_INSTALL_PATH</code> </p>
</blockquote>
<p>Set the <em>Promesh</em> installation path: </p><div class="fragment"><div class="line">export PROMESH_INSTALL_PATH=/full/path/to/Promesh/install</div></div><!-- fragment --><p>Now, we can compile the <em>Promesh</em> library, create its Python bindings, and build other utilities. Note that the current name for the Promesh project as installed from GitHub is Nemosys, so the PROMESH_PROJECT_PATH should be set to the directory into which Nemosys was cloned above: </p><div class="fragment"><div class="line">cd ${PROMESH_PROJECT_PATH}</div><div class="line">mkdir build &amp;&amp; cd build</div></div><!-- fragment --><p> The CMake commad must include a prefix path that indicates the location of the dependencies. The command below can be altered to include or exclude TPLs as needed. Note that if <code>ENABLE_CFMESH</code> is <code>ON</code>, the <em>OpenFOAM</em> environment must be set prior to running the cmake command.</p>
<p>See the build options tabulated below for more information on the available CMake options.</p>
<table class="doxtable">
<tr>
<th>If your system is... </th><th>use the command...  </th></tr>
<tr>
<td>Ubuntu </td><td><code>cmake .. -DCMAKE_PREFIX_PATH="${PROMESH_DEPS_INSTALL_PATH}/opencascade;${PROMESH_DEPS_INSTALL_PATH}/vtk;${PROMESH_DEPS_INSTALL_PATH}/netgen" -DCMAKE_INSTALL_PREFIX=${PROMESH_INSTALL_PATH}/Promesh -DENABLE_TESTING=ON -DBUILD_SHARED_LIBS=ON -DCMAKE_BUILD_TYPE=Release</code> </td></tr>
<tr>
<td>CentOS </td><td><code>cmake3 .. -DCMAKE_PREFIX_PATH="${PROMESH_DEPS_INSTALL_PATH}/opencascade;${PROMESH_DEPS_INSTALL_PATH}/vtk;${PROMESH_DEPS_INSTALL_PATH}/netgen" -DCMAKE_INSTALL_PREFIX=${PROMESH_INSTALL_PATH}/Promesh -DENABLE_TESTING=ON -DBUILD_SHARED_LIBS=ON -DCMAKE_BUILD_TYPE=Release</code> </td></tr>
</table>
<p>To complete the installation: </p><div class="fragment"><div class="line">make -j$(nproc)</div><div class="line">make install</div></div><!-- fragment --><p>Executing the commands above will build all libraries, executables, and bindings. The libraries are installed in <code>$PROMESH_INSTALL_PATH/lib</code>. Executables are installed in <code>$PROMESH_INSTALL_PATH/bin</code>. If Python bindings are enabled, the <code>pyNemosys</code> module is installed for the user. The <code>pyNemosys</code> module can be imported in Python as <code>import pyNemosys</code>. The build configuration can be modified through the CMake Curses interface, <code>ccmake</code>, or by passing the command line options to <code>cmake</code>.</p>
<p>The following table contains all available CMake options to configure <em>Promesh</em> functionality. Any necessary third-party library for each option is listed in the notes section.</p>
<p><b>For LGPL licensed software:</b></p>
<table class="doxtable">
<tr>
<th>Option name </th><th>Option description </th><th>Default </th><th>Notes  </th></tr>
<tr>
<td><code>ENABLE_CONSRV_SURFACE_TRANSFER</code> </td><td>Enable conservative surface transfer </td><td>OFF </td><td>Requires <em>IMPACT</em> </td></tr>
<tr>
<td><code>ENABLE_CONSRV_VOLUME_TRANSFER</code> </td><td>Enable conservative volume transfer </td><td>OFF </td><td>Requires MPI </td></tr>
<tr>
<td><code>ENABLE_DOCUMENTATION</code> </td><td>Create and install the HTML based API documentation </td><td>ON </td><td>Requires Doxygen </td></tr>
<tr>
<td><code>ENABLE_HDF5</code> </td><td>Enable HDF5 extensions </td><td>OFF </td><td>Requires HDF5 </td></tr>
<tr>
<td><code>ENABLE_METIS</code> </td><td>Enable Metis partitioner </td><td>OFF </td><td>Requires <em>METIS</em> </td></tr>
<tr>
<td><code>ENABLE_MLAMR</code> </td><td>Enable machine learning based AMR </td><td>OFF </td><td>Requires frugally-deep library </td></tr>
<tr>
<td><code>ENABLE_MPI</code> </td><td>Enable MPI support </td><td>OFF </td><td>Requires MPI compiler </td></tr>
<tr>
<td><code>ENABLE_NETGEN</code> </td><td>Enable <em>Netgen</em> meshing engine </td><td>ON </td><td>Requires <em>Netgen</em> </td></tr>
<tr>
<td><code>ENABLE_OMEGAH_CUDA</code> </td><td>Enable GPU for <em><a class="el" href="namespaceOmega__h.html">Omega_h</a></em> </td><td>OFF </td><td>Requires <em>Kokkos</em> </td></tr>
<tr>
<td><code>ENABLE_OPENCASCADE</code> </td><td>Enable <em>OpenCASACADE</em> support </td><td>ON </td><td>Requires <em>OpenCASCADE</em> (OCCT) </td></tr>
<tr>
<td><code>ENABLE_OPENMP</code> </td><td>Enable OpenMP </td><td>ON </td><td></td></tr>
<tr>
<td><code>ENABLE_PYTHON_BINDINGS</code> </td><td>Enable Python bindings </td><td>OFF </td><td>Requires Python 3 and SWIG 3 </td></tr>
<tr>
<td><code>ENABLE_TESTING</code> </td><td>Enable testing </td><td>ON </td><td></td></tr>
</table>
<p><b>For GPL licensed software, additional build options can be included:</b></p>
<table class="doxtable">
<tr>
<th>Option name </th><th>Option description </th><th>Default </th><th>Notes  </th></tr>
<tr>
<td><code>ENABLE_CFMSH</code> </td><td>Enable <em>cfMesh</em> Meshing engine </td><td>OFF </td><td>Requires <em>OpenFOAM</em>, requires that <code>ENABLE_GPL</code> is <code>ON</code> </td></tr>
<tr>
<td><code>ENABLE_GMSH</code> </td><td>Enable <em>Gmsh</em> </td><td>OFF </td><td>Requires that <code>ENABLE_GPL</code> is <code>ON</code> </td></tr>
<tr>
<td><code>ENABLE_GPL</code> </td><td>Allow linking against GPL libraries </td><td>OFF </td><td>Will make the combined project fall under GPL license requirements </td></tr>
</table>
<p><b>Enabling cfMesh</b></p>
<p><em>cfMesh</em> is an open-source meshing engine implemented on top of <em>OpenFOAM</em>. <em>Promesh</em> comes with a fully integrated <em>cfMesh</em>-based meshing module. To enable the capability, <em>Promesh</em> should be compiled with <code>ENABLE_CFMSH=ON</code>.</p>
<blockquote class="doxtable">
<p><b>Note:</b> <em>cfMesh</em> depends on <em>OpenFOAM</em>, so before starting the compile process make sure to load <em>OpenFOAM</em> environment variables. Depending on the version, <em>OpenFOAM</em> can be loaded by sourcing the bashrc, or cshrc scripts provided in the <code>OpenFoam-x.y/etc/</code>. On a default installation, this can be done with </p><div class="fragment"><div class="line">. /usr/lib/openfoam/openfoam2006/etc/bashrc</div></div><!-- fragment --> </blockquote>
<p>Refer to the <em>OpenFOAM</em> documentation for further instructions. After the <em>OpenFOAM</em> environment is loaded, enable a <em>cfMesh</em> build by adding this line to the cmake command: </p><div class="fragment"><div class="line">-DENABLE_CFMSH=ON -DENABLE_GPL=ON</div></div><!-- fragment --><p><b>Enabling CUDA for <a class="el" href="namespaceOmega__h.html">Omega_h</a></b></p>
<p><a class="el" href="namespaceOmega__h.html">Omega_h</a> can be built with CUDA support using the Kokkos backend, assuming Kokkos is built with CUDA support. Currently, only Kokkos version 2 is supported. To enable this, make sure that the following flag is set: </p><div class="fragment"><div class="line">-DENABLE_OMEGAH_CUDA=ON</div></div><!-- fragment --><p> and that <code>CMAKE_PREFIX_PATH</code> (or <code>$PATH</code>) contains <code>${PROMESH_DEPS_INSTALL_PATH}/kokkos/lib/CMake</code>. Note that both Kokkos and <em>Promesh</em> must be built as shared libraries (<code>-DBUILD_SHARED_LIBS=ON</code>).</p>
<p>From the build directory, execute the following command to test the installation: </p><div class="fragment"><div class="line">make test</div></div><!-- fragment --><p>This will run all tests that are applicable to your installation of <em>Promesh</em>. Depending on how many modules are enabled, this may take anywhere from seconds to several minutes. Specific tests can be run using <code>ctest -R &lt;testname&gt;</code>, for example: </p><div class="fragment"><div class="line">ctest -R nucMeshTest</div></div><!-- fragment --><p>To get a list of possible test names, use: </p><div class="fragment"><div class="line">ctest -N</div></div><!-- fragment --><p>Using <em>Promesh</em> requires setting the environment. In most cases, this will be done by setting the <code>LD_LIBRARY_PATH</code> in the terminal from which <em>Promesh</em> cases will be run, via a command like the one below:</p>
<div class="fragment"><div class="line">export PROMESH_DEPS_INSTALL_PATH=/path/to/dependencies/installation/path</div><div class="line"></div><div class="line">export LD_LIBRARY_PATH=${PROMESH_DEPS_INSTALL_PATH}/vtk/lib:${LD_LIBRARY_PATH}</div><div class="line">export LD_LIBRARY_PATH=${PROMESH_DEPS_INSTALL_PATH}/opencascade/lib:${LD_LIBRARY_PATH}</div><div class="line">export LD_LIBRARY_PATH=${PROMESH_DEPS_INSTALL_PATH}/netgen/lib:${LD_LIBRARY_PATH}</div></div><!-- fragment --><p>For the GPL licensed version of <em>Promesh</em>, additional library paths must be set for <em>Gmsh</em> and <em>OpenFOAM</em>: </p><div class="fragment"><div class="line">export LD_LIBRARY_PATH=${PROMESH_DEPS_INSTALL_PATH}/gmsh/lib:${LD_LIBRARY_PATH}</div><div class="line">export LD_LIBRARY_PATH=/usr/lib/openfoam/openfoam2006/platforms/linux64GccDPInt32Opt/lib/openmpi-system:${LD_LIBRARY_PATH}</div></div><!-- fragment --><p>The <em>OpenFOAM</em> environment must also be set: </p><div class="fragment"><div class="line">. /usr/lib/openfoam/openfoam2006/etc/bashrc</div></div><!-- fragment --><p>The simplest method to run a <em>Promesh</em> program is to start with a JSON input file. A sample one is provided below:</p>
<div class="fragment"><div class="line">{</div><div class="line"> &quot;Program Type&quot;: &quot;NucMesh Generation&quot;,</div><div class="line"> &quot;Mesh File Options&quot;: {</div><div class="line">  &quot;Output Mesh File&quot;: &quot;test.vtu&quot;</div><div class="line"> },</div><div class="line"> &quot;NucMesh Options&quot;: {</div><div class="line">  &quot;Shapes&quot;: [</div><div class="line">   {</div><div class="line">    &quot;Type&quot;: &quot;Rectangular Array&quot;,</div><div class="line">    &quot;Grid Distance&quot;: [1.5, 1.5],</div><div class="line">    &quot;Pattern&quot;: [[0, 1],[1, 0]],</div><div class="line">    &quot;Shapes&quot;: [</div><div class="line">     {</div><div class="line">      &quot;Type&quot;: &quot;Circles&quot;,</div><div class="line">      &quot;Rings&quot;: [</div><div class="line">       {</div><div class="line">        &quot;Radius&quot;: 0.5,</div><div class="line">        &quot;Mesh&quot;: {&quot;Type&quot;: &quot;T&quot;},</div><div class="line">        &quot;Material&quot;: &quot;A&quot;</div><div class="line">       },</div><div class="line">       {</div><div class="line">        &quot;Radius&quot;: 1.0,</div><div class="line">        &quot;Mesh&quot;: {</div><div class="line">         &quot;Type&quot;: &quot;S&quot;,</div><div class="line">         &quot;Number of Elems&quot;: [3, 8]</div><div class="line">        },</div><div class="line">        &quot;Material&quot;: &quot;B&quot;</div><div class="line">       }</div><div class="line">      ]</div><div class="line">     },</div><div class="line">     {</div><div class="line">      &quot;Type&quot;: &quot;Circles&quot;,</div><div class="line">      &quot;Rings&quot;: [</div><div class="line">       {</div><div class="line">        &quot;Radius&quot;: 0.5,</div><div class="line">        &quot;Mesh&quot;: {&quot;Type&quot;: &quot;Q&quot;},</div><div class="line">        &quot;Material&quot;: &quot;C&quot;</div><div class="line">       },</div><div class="line">       {</div><div class="line">        &quot;Radius&quot;: 1.0,</div><div class="line">        &quot;Mesh&quot;: {</div><div class="line">         &quot;Type&quot;: &quot;S&quot;,</div><div class="line">         &quot;Number of Elems&quot;: [3, 8]</div><div class="line">        },</div><div class="line">        &quot;Material&quot;: &quot;D&quot;</div><div class="line">       }</div><div class="line">      ]</div><div class="line">     }</div><div class="line">    ]</div><div class="line">   }</div><div class="line">  ]</div><div class="line"> }</div><div class="line">}</div></div><!-- fragment --><p>To run this program, copy and paste the input above into your favorite text editor and save it in the build folder as <code>test_run.json</code>. Within a terminal, navigate to the build folder and enter: </p><div class="fragment"><div class="line">./nemosysRun test_run.json</div></div><!-- fragment --><p> This should generate the following printout in the terminal:</p>
<div class="fragment"><div class="line">srvBase constructed</div><div class="line">Gmsh initialized</div><div class="line">geoMeshBase constructed</div><div class="line">srvBase destructed</div><div class="line">geoMeshBase constructed</div><div class="line">vtkGeoMesh constructed</div><div class="line">vtkGeoMesh destructed</div><div class="line">geoMeshBase destructed</div><div class="line">geoMeshBase destructed</div><div class="line">Gmsh finalized</div></div><!-- fragment --><p>A <code>test.vtu</code> file should appear within the build directory. This can be visualized with <em>Paraview</em> or your visualization software of choice:</p>
<div class="image">
<img src="test_run.png" alt="test_run.png"/>
<div class="caption">
The test.vtu mesh generated with NucMesh</div></div>
 <p>To report errors, broken links, or other feedback, contact the <em>Promesh</em> team at <a href="#" onclick="location.href='mai'+'lto:'+'pro'+'me'+'sh@'+'il'+'lin'+'oi'+'sro'+'cs'+'tar'+'.c'+'om'; return false;">prome<span style="display: none;">.nosp@m.</span>sh@i<span style="display: none;">.nosp@m.</span>llino<span style="display: none;">.nosp@m.</span>isro<span style="display: none;">.nosp@m.</span>cstar<span style="display: none;">.nosp@m.</span>.com</a> or open an issue in GitHub at <a href="https://github.com/IllinoisRocstar/Nemosys/issues">https://github.com/IllinoisRocstar/Nemosys/issues</a> </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Wed Jan 26 2022 16:22:44 for NEMoSys by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>

//Plane Definition
SetFactory("OpenCASCADE");
z = 0.800000;
pl = 1.000000;
lc = 0.01;
Point(1) = {pl, -pl, z, lc};
Point(2) = {-pl, -pl, z, lc};
Point(3) = {-pl, pl, z, lc};
Point(4) = {pl,  pl, z, lc} ;
Line(1) = {1,2} ;
Line(2) = {2,3} ;
Line(3) = {3,4} ;
Line(4) = {4,1} ;
Line Loop(1) = {1,2,3,4} ;
Plane Surface(1) = {1} ;
Periodic Line {1} = {-3} ;
Periodic Line {2} = {-4} ;
//All Spheres
lc = 0.01;
SetFactory("OpenCASCADE");
Sphere(5) = {0.106987,0.118014,-0.092624,0.403113};
Sphere(6) = {0.106987,0.518014,0.707376,0.403113};
Sphere(7) = {0.106987,0.518014,-1.292624,0.403113};
Sphere(8) = {0.106987,0.918014,-0.492624,0.403113};
Sphere(9) = {0.106987,-1.081986,-0.492624,0.403113};
Sphere(10) = {-0.893013,-0.681986,0.307376,0.403113};
Sphere(11) = {1.106987,-0.681986,0.307376,0.403113};
Sphere(12) = {1.106987,1.318014,0.307376,0.403113};
Sphere(13) = {-0.893013,1.318014,0.307376,0.403113};
Sphere(14) = {-0.893013,0.918014,-0.492624,0.403113};
Sphere(15) = {1.106987,0.918014,-0.492624,0.403113};
Sphere(16) = {1.106987,-1.081986,-0.492624,0.403113};
Sphere(17) = {-0.893013,-1.081986,-0.492624,0.403113};
Sphere(18) = {-0.393013,-0.481986,-0.292624,0.403113};
Sphere(19) = {-0.393013,-0.881986,0.907376,0.403113};
Sphere(20) = {-0.393013,1.118014,0.907376,0.403113};
Sphere(21) = {-0.393013,1.118014,-1.092624,0.403113};
Sphere(22) = {-0.393013,-0.881986,-1.092624,0.403113};
Sphere(23) = {0.606987,0.318014,-0.692624,0.403113};
Sphere(24) = {-1.393013,0.318014,-0.692624,0.403113};
Sphere(25) = {-1.393013,0.318014,1.307376,0.403113};
Sphere(26) = {0.606987,0.318014,1.307376,0.403113};
Sphere(27) = {-0.893013,0.518014,0.707376,0.403113};
Sphere(28) = {1.106987,0.518014,0.707376,0.403113};
Sphere(29) = {1.106987,0.518014,-1.292624,0.403113};
Sphere(30) = {-0.893013,0.518014,-1.292624,0.403113};
Sphere(31) = {0.106987,-0.281986,-0.892624,0.403113};
Sphere(32) = {0.106987,-0.281986,1.107376,0.403113};
Sphere(33) = {0.106987,-0.681986,0.307376,0.403113};
Sphere(34) = {0.106987,1.318014,0.307376,0.403113};
Sphere(35) = {0.606987,0.718014,0.107376,0.403113};
Sphere(36) = {-1.393013,0.718014,0.107376,0.403113};
Sphere(37) = {-1.393013,-1.281986,0.107376,0.403113};
Sphere(38) = {0.606987,-1.281986,0.107376,0.403113};
Sphere(39) = {-0.393013,0.718014,0.107376,0.403113};
Sphere(40) = {-0.393013,-1.281986,0.107376,0.403113};
Sphere(41) = {0.606987,-0.881986,0.907376,0.403113};
Sphere(42) = {-1.393013,-0.881986,0.907376,0.403113};
Sphere(43) = {-1.393013,1.118014,0.907376,0.403113};
Sphere(44) = {-1.393013,1.118014,-1.092624,0.403113};
Sphere(45) = {-1.393013,1.118014,0.907376,0.403113};
Sphere(46) = {0.606987,1.118014,0.907376,0.403113};
Sphere(47) = {0.606987,1.118014,-1.092624,0.403113};
Sphere(48) = {0.606987,-0.881986,-1.092624,0.403113};
Sphere(49) = {-0.893013,-0.281986,-0.892624,0.403113};
Sphere(50) = {1.106987,-0.281986,-0.892624,0.403113};
Sphere(51) = {1.106987,-0.281986,1.107376,0.403113};
Sphere(52) = {-0.893013,-0.281986,1.107376,0.403113};
Sphere(53) = {-0.393013,0.318014,-0.692624,0.403113};
Sphere(54) = {-0.393013,0.318014,1.307376,0.403113};
Sphere(55) = {0.606987,-0.481986,-0.292624,0.403113};
Sphere(56) = {-1.393013,-0.481986,-0.292624,0.403113};
Sphere(57) = {0.606987,-0.081986,0.507376,0.403113};
Sphere(58) = {-1.393013,-0.081986,0.507376,0.403113};
Sphere(59) = {-0.393013,-0.081986,0.507376,0.403113};
Sphere(60) = {-0.893013,0.118014,-0.092624,0.403113};
Sphere(61) = {1.106987,0.118014,-0.092624,0.403113};
Physical Volume("sphere_1.00") = {5:61};
s0 = BooleanIntersection{ Surface{1}; }{Volume{5:61}; };
Physical Surface("sphere_1.00") = s0();
d = BooleanDifference{ Surface{1}; Delete;}{Volume{5:61}; Delete;};
Physical Surface("Domain") = d();
//Meshhhh
Mesh.Algorithm = 6; //Frontal
Mesh.Optimize = 1; // Gmsh smoother, works with boundary layers (netgen version does not).
Mesh.CharacteristicLengthFromPoints = 0;
Mesh.CharacteristicLengthExtendFromBoundary = 0;
Mesh.CharacteristicLengthMax = 0.05;
Mesh.RemeshAlgorithm = 1; //(0) nosplit (1) automatic (2) split only with metis
Mesh 3;
//Save StrCat(StrPrefix(General.FileName), ".vtk");
